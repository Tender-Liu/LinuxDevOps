# 阿里云 ACK 企业实战


## 教学目标
- 掌握阿里云容器服务 ACK（Aliyun Container Service for Kubernetes）的基本概念和使用方法。
- 理解如何在阿里云 VPC 环境中部署和管理 Kubernetes 集群。
- 学会将已掌握的 Kubernetes 核心组件知识（Pod、ConfigMap、Secret、Deployment、StatefulSet、DaemonSet、Service、Ingress-Nginx 及调度策略）应用到 ACK 中。
- 熟悉阿里云 ACK 与 VPC、ECS 等核心组件的集成方式。

## 学习提前准备
- **Kubernetes 基础**：学员已在虚拟机实验环境中完成 Kubernetes 的全部学习，熟练掌握 Pod、ConfigMap、Secret、Deployment、StatefulSet、DaemonSet、Service、Ingress-Nginx 以及调度策略等核心组件的使用。
- **阿里云基础**：学员已学习阿里云 VPC 和 ECS 等核心组件，并为 ACK 的网络环境做好准备。


## 第一部分：阿里云 ACK 基础介绍
谢谢您的肯定！接下来我会为您详细介绍阿里云 ACK（Aliyun Container Service for Kubernetes）的理论知识，重点讲解其概念、架构、优势以及与其他 Kubernetes 解决方案的对比。以下内容将以清晰的结构呈现，方便您理解和使用。

### 一、什么是阿里云 ACK
**阿里云 ACK（Aliyun Container Service for Kubernetes）** 是阿里云提供的一种托管式 Kubernetes 服务，旨在帮助用户快速构建、部署和管理容器化应用，而无需手动管理底层基础设施。ACK 基于开源的 Kubernetes 技术，结合阿里云的云计算能力，提供了一个高可用、高性能、易于扩展的容器编排平台。

- **核心定位**：ACK 是一种 **PaaS（平台即服务）** 产品，专注于容器集群的管理，降低了用户自建 Kubernetes 集群的复杂性和运维成本。
- **发展背景**：随着容器技术（如 Docker）和容器编排工具（如 Kubernetes）的普及，企业对高效容器管理的需求日益增加。阿里云 ACK 应运而生，旨在为企业提供一站式的容器解决方案。


### 二、ACK 的架构与工作原理
ACK 的架构设计充分利用了阿里云的基础设施，并对 Kubernetes 进行了深度优化。以下是 ACK 的核心架构和运行机制：

#### 1. **集群类型**
ACK 提供两种主要集群类型，满足不同用户需求：
- **托管集群（Managed Cluster）**：
  - 控制平面（Master 节点，包括 kube-apiserver、etcd 等）由阿里云完全托管，用户无需关心控制平面的运维。
  - 用户只需管理 Worker 节点（运行工作负载的节点），可以自定义节点的配置和数量。
  - 适合大多数企业用户，降低了运维门槛。
- **专有集群（Dedicated Cluster）**：
  - 用户独占整个 Kubernetes 集群，包括控制平面和 Worker 节点。
  - 提供更高的隔离性和自定义能力，适合对安全性和合规性要求极高的场景。
  - 用户需要承担更多的运维工作，但仍可享受阿里云的技术支持。

#### 2. **核心组件**
ACK 的架构基于 Kubernetes 的标准组件，并结合阿里云的云原生技术进行优化：
- **控制平面（Control Plane）**：
  - 包括 kube-apiserver（API 服务器）、kube-controller-manager（控制器管理器）、kube-scheduler（调度器）和 etcd（分布式存储）。
  - 在托管集群中，这些组件由阿里云管理，运行在高可用的云基础设施上。
- **Worker 节点**：
  - 运行用户的容器工作负载，包含 kubelet（节点代理）和 kube-proxy（网络代理）。
  - 节点基于阿里云 ECS（弹性计算服务）实例，用户可选择不同规格和操作系统。
- **网络插件**：
  - 支持多种网络模式，包括 Flannel（Overlay 网络）和 Terway（基于阿里云 ENI 弹性网卡的 Underlay 网络）。
  - Terway 是阿里云推荐的网络插件，与 VPC 深度集成，提供高性能、低延迟的网络通信。
- **存储插件**：
  - 集成阿里云的存储服务，如 NAS（网络附加存储）、OSS（对象存储）和磁盘存储，支持动态卷分配（PV/PVC）。
- **其他插件**：
  - 提供日志（SLS）、监控（Prometheus）、安全（容器安全扫描）等增值服务。

#### 3. **工作流程**
- 用户通过阿里云控制台或 CLI 创建 ACK 集群，指定 VPC、子网、节点规格等参数。
- 阿里云自动完成控制平面和 Worker 节点的部署，并配置网络、存储等资源。
- 用户通过 kubectl 或控制台与集群交互，部署应用、配置资源和监控状态。
- ACK 自动处理集群的版本升级、节点修复和负载均衡等任务。


### 三、阿里云 ACK 的核心优势
ACK 相较于自建 Kubernetes 集群或其他云厂商的容器服务，具有以下显著优势：

#### 1. **托管服务，降低运维成本**
- **控制平面托管**：在托管集群模式下，控制平面的部署、升级和维护完全由阿里云负责，用户无需担心 Master 节点的可用性和稳定性。
- **自动化运维**：ACK 提供自动化的节点修复、版本升级和集群扩展功能，减少了人工干预的需求。
- **一键创建**：通过阿里云控制台，用户只需几分钟即可完成一个高可用 Kubernetes 集群的创建，无需手动安装和配置。

#### 2. **与阿里云生态深度集成**

- **网络集成**：通过 Terway 网络插件，ACK 与阿里云 VPC 无缝集成，支持弹性网卡（ENI）直接分配给 Pod，提供高性能网络。
- **存储集成**：支持阿里云多种存储服务（如 NAS、OSS、云盘），满足不同场景的存储需求。
- **负载均衡**：自动绑定阿里云 SLB（负载均衡），实现外部流量的高效分发。
- **其他服务**：与阿里云日志服务（SLS）、监控服务（ARMS）、数据库（RDS）等无缝对接，提供完整的云原生解决方案。

#### 3. **高可用性和弹性扩展**

- **多可用区部署**：ACK 支持将节点分布在多个可用区（如杭州的 B、D、E、F 区），确保集群的高可用性。
- **自动扩缩容**：支持 HPA（水平 Pod 自动扩展）和集群节点自动扩缩容，根据负载动态调整资源。
- **故障恢复**：阿里云基础设施提供高可靠性的底层支持，ACK 能够快速恢复节点故障。

#### 4. **安全性与合规性**
- **网络隔离**：通过 VPC 和子网划分（如您提供的 Public 和 Private 子网），实现集群与外部环境的隔离。
- **权限管理**：集成阿里云 RAM（资源访问管理），支持细粒度的权限控制。
- **合规支持**：ACK 符合多种行业标准和合规要求，适合金融、医疗等敏感行业。

#### 5. **丰富的生态与工具支持**
- **插件生态**：提供丰富的插件，如 Ingress-Nginx、Prometheus、Istio 等，支持一键安装。
- **DevOps 支持**：集成 CI/CD 工具，支持容器镜像构建和自动化部署。
- **社区兼容性**：完全兼容 Kubernetes 社区标准，用户熟悉的 kubectl 和 YAML 文件可直接使用。

#### 6. **成本优化**
- **按需付费**：Worker 节点基于 ECS 实例，按小时或按需计费，节省资源成本。
- **资源复用**：通过 Terway 网络模式，Pod 可直接使用 VPC 内的 IP 地址，避免 Overlay 网络的性能开销。


### 四、ACK 与自建 Kubernetes 集群的对比
为了帮助您更好地理解 ACK 的价值，以下是将 ACK 与虚拟机自建 Kubernetes 集群进行对比：

| **维度**            | **阿里云 ACK**                              | **自建 Kubernetes 集群**                  |
|---------------------|--------------------------------------------|------------------------------------------|
| **部署难度**        | 一键创建，几分钟完成                      | 手动安装配置，耗时长，需专业知识         |
| **运维成本**        | 控制平面托管，运维负担低                  | 需自行维护 Master 和 Worker 节点         |
| **高可用性**        | 自动支持多可用区部署，故障恢复快          | 需手动配置 HA，依赖硬件和网络稳定性      |
| **扩展性**          | 支持自动扩缩容，弹性强                    | 扩展需手动添加节点，配置复杂             |
| **生态集成**        | 与阿里云 VPC、存储、负载均衡无缝集成      | 需自行集成外部服务，适配成本高           |
| **安全性**          | 集成 RAM 和 VPC 隔离，安全性高            | 需自行配置网络隔离和权限管理             |
| **成本**            | 按需付费，初期成本低                      | 硬件和人力成本高，初期投入大             |

**总结**：对于大多数企业和开发者而言，ACK 提供了更低的入门门槛、更高效的运维体验和更强的生态支持，非常适合从虚拟机环境过渡到云原生环境的用户。


### 五、ACK 的适用场景
ACK 适用于以下常见场景，结合您的学员背景，这些场景可以作为学习的重点：
- **微服务架构**：通过 ACK 部署和管理复杂的微服务应用，利用 Service 和 Ingress 实现服务发现和流量管理。
- **CI/CD 流水线**：集成阿里云镜像服务（ACR），实现代码构建、镜像推送和自动化部署。
- **大数据与 AI 应用**：利用 ACK 的 GPU 节点支持，运行机器学习和深度学习任务。
- **高可用业务**：通过多可用区部署和自动扩缩容，确保业务系统的高可用性和稳定性。
- **混合云部署**：结合阿里云和本地环境，通过 ACK Anywhere 实现统一的容器管理。

### 第二部分：ACK 集群网络规划与 VPC 集成-前置条件
**目标**：理解 ACK 集群如何与已准备好的 VPC 网络环境集成。

- **内容**：
  1. **回顾 VPC 网络结构**：
     - VPC 名称：`vpc-prod-shiqi`，IP 范围：`10.8.0.0/16`，覆盖所有子网。
     - 可用区分布：杭州的 B、D、E、F 四个可用区，确保高可用性。
     - 交换机（子网）划分：
       - **Public 子网**：`switch-public-region-b`（10.8.0.0/24，B 区）、`switch-public-region-d`（10.8.1.0/24，D 区）。
       - **Private 子网**：`switch-private-region-b`（10.8.4.0/22，B 区）、`switch-private-region-d`（10.8.8.0/22，D 区）、`switch-private-region-e`（10.8.12.0/22，E 区）、`switch-private-region-f`（10.8.16.0/22，F 区）。
     - NAT 网关：`nat-route-private` 部署在 Public 子网（10.8.1.0/24，D 区），绑定 EIP `121.43.144.176`，用于 Private 子网访问公网。
     - 路由表：`route-prod-shiqi` 管理所有子网流量，Private 子网通过 NAT 网关访问互联网。
  2. **ACK 网络模式**：
     - **Flannel 模式**：适合简单的网络需求，基于 overlay 网络。
     - **Terway 模式**：推荐模式，基于阿里云 ENI（弹性网卡），与 VPC 深度集成，提供高性能网络。
  3. **ACK 集群网络规划**：
     - ACK 集群的 Pod 网络 CIDR：建议选择与 VPC CIDR 不重叠的范围（如 `172.16.0.0/16`）。
     - 节点分布：将 ACK 节点分布在 Private 子网的多个可用区（如 B、D、E、F），确保高可用性。
     - Service 网络：选择与 Pod 网络不重叠的 CIDR（如 `192.168.0.0/16`）。
     - 公网访问：通过 SLB（负载均衡）绑定 Public 子网的 EIP 实现外部访问。

- **学习任务**：
  - 在阿里云控制台查看 VPC 和子网配置，熟悉网络结构。
  - 学习 Terway 网络插件的配置方式，理解其与 VPC 的集成原理。


## 第三部分：阿里云 ACR 理论与 Harbor 对比

### 一、什么是阿里云 ACR
**阿里云 ACR（Aliyun Container Registry）** 是阿里云提供的一种托管式容器镜像服务，用于存储、分发和管理 Docker 镜像。ACR 旨在帮助用户构建、存储和分发容器镜像，支持与阿里云 ACK（容器服务 Kubernetes）无缝集成，提供高效、安全的镜像管理能力。

#### 1. **核心功能**
- **镜像存储**：支持 Docker 镜像和 OCI（Open Container Initiative）标准的镜像存储，提供无限的存储空间。
- **镜像分发**：通过全球加速节点，提供高速的镜像拉取和推送服务，适合分布式团队和 CI/CD 流程。
- **权限管理**：集成阿里云 RAM（资源访问管理），支持细粒度的访问控制，确保镜像安全。
- **镜像安全**：内置镜像漏洞扫描功能，自动检测镜像中的安全漏洞并提供修复建议。
- **版本管理**：支持镜像标签（Tag）管理，方便版本控制和回滚。
- **触发器与自动化**：支持镜像构建触发器，自动触发 CI/CD 流水线中的构建和部署任务。

#### 2. **架构与工作原理**
- **镜像仓库**：ACR 提供两种仓库类型：
  - **企业版仓库**：面向企业用户，支持更高的并发和性能，提供镜像缓存和跨地域复制功能。
  - **个人版仓库**：适合个人开发者，免费使用但功能和性能受限。
- **地域与加速**：ACR 部署在阿里云的多个地域，每个地域有独立的镜像仓库，支持就近访问和全球加速。
- **与 ACK 集成**：ACR 可直接与 ACK 集群对接，集群中的 Pod 可通过内网快速拉取镜像，避免公网传输的延迟和成本。

#### 3. **使用场景**
- **CI/CD 集成**：在持续集成和持续部署流程中，ACR 作为镜像存储和分发的核心组件，支持自动化构建和部署。
- **微服务开发**：为微服务架构中的多个服务提供统一的镜像管理平台。
- **跨团队协作**：通过权限管理，允许多个团队共享镜像仓库，提高开发效率。
- **安全合规**：通过漏洞扫描和访问控制，满足企业对镜像安全和合规性的要求。


### 二、阿里云 ACR 的优势
ACR 作为云原生生态的一部分，具备以下显著优势：

#### 1. **与阿里云生态深度集成**
- **无缝对接 ACK**：ACR 与阿里云容器服务（ACK）无缝集成，集群可通过内网高速拉取镜像，提升部署效率。
- **支持其他服务**：与阿里云 CI/CD 工具、日志服务（SLS）等集成，提供完整的云原生开发体验。
- **内网传输**：在阿里云 VPC 环境中，镜像传输走内网，避免公网带宽成本和延迟。

#### 2. **高性能与全球加速**
- **全球节点**：ACR 在全球多个地域部署镜像仓库，支持就近访问和镜像分发。
- **镜像缓存**：企业版支持镜像缓存功能，加速镜像拉取，特别适合大规模集群部署。
- **跨地域复制**：支持镜像跨地域同步，确保分布式团队和应用的镜像一致性。

#### 3. **安全性与可靠性**
- **漏洞扫描**：自动扫描镜像中的安全漏洞，并提供修复建议，帮助用户构建安全的容器环境。
- **权限控制**：通过 RAM 实现细粒度的访问控制，支持子账号、角色和临时凭证管理。
- **高可用性**：基于阿里云基础设施，ACR 提供高可用性和数据冗余，确保镜像不会丢失。

#### 4. **易用性与自动化**
- **控制台与 CLI 支持**：通过阿里云控制台或 CLI 工具，用户可以轻松管理镜像仓库和镜像。
- **构建触发器**：支持基于代码提交或定时任务的镜像构建自动化，简化 CI/CD 流程。
- **免费额度**：个人版提供免费的基础服务，降低小型团队和个人开发者的使用成本。


### 三、Harbor 简介
**Harbor** 是一个开源的容器镜像仓库，由 VMware 发起并维护，广泛用于企业内部的私有镜像管理。Harbor 提供了一个安全、可靠的镜像存储和分发平台，特别适合需要自建镜像仓库的场景。

#### 1. **核心功能**
- **镜像存储与管理**：支持 Docker 镜像和 OCI 镜像，提供镜像标签管理和版本控制。
- **权限管理**：支持基于角色的访问控制（RBAC），允许多用户和多团队协作。
- **镜像安全**：集成漏洞扫描工具（如 Trivy），检测镜像中的安全问题。
- **镜像复制**：支持镜像跨仓库和跨实例的复制，适合分布式环境。
- **Web UI**：提供直观的图形界面，方便用户管理镜像和配置仓库。
- **API 支持**：提供 RESTful API，支持与 CI/CD 工具集成。

#### 2. **架构与工作原理**
- Harbor 是一个自建服务，通常部署在企业内部的服务器或虚拟机上。
- 核心组件包括代理服务、核心服务、数据库、镜像存储和日志系统。
- 支持多种存储后端，如本地文件系统、S3、Swift 等，灵活性较高。
- 可通过 Docker Compose 或 Helm Chart 快速部署。

#### 3. **使用场景**
- **私有化部署**：适合对数据安全和隐私有严格要求的企业，镜像数据完全存储在内部。
- **离线环境**：在无公网或限制公网访问的环境中，Harbor 可作为独立的镜像仓库使用。
- **开源生态**：作为开源项目，Harbor 允许企业根据需求定制功能。

### 四、阿里云 ACR 与 Harbor 的对比
为了帮助学员更清晰地理解两者的区别和适用场景，以下从多个维度对阿里云 ACR 和 Harbor 进行详细对比：

| **维度**            | **阿里云 ACR**                              | **Harbor**                               |
|---------------------|--------------------------------------------|-----------------------------------------|
| **部署方式**        | 托管服务，无需自建，直接在阿里云上使用     | 自建服务，需在企业内部服务器或云上部署   |
| **运维成本**        | 阿里云负责运维，用户无需关心基础设施      | 需自行维护服务器、存储和网络，运维成本高 |
| **与 Kubernetes 集成** | 与 ACK 无缝集成，内网高速拉取镜像         | 可与任何 Kubernetes 集群集成，但需配置   |
| **性能与加速**      | 全球加速节点，镜像缓存和跨地域复制         | 性能依赖部署环境，无内置全球加速功能     |
| **安全性**          | 集成 RAM 权限管理，内置漏洞扫描            | 支持 RBAC 和漏洞扫描，但需自行配置       |
| **存储与扩展**      | 无限存储空间，基于阿里云基础设施           | 存储受限于部署环境，需手动扩展           |
| **易用性**          | 阿里云控制台和 CLI，操作简单               | 提供 Web UI 和 API，但部署配置较复杂     |
| **成本**            | 按需付费，个人版免费，企业版按使用量计费   | 开源免费，但需承担硬件和人力成本         |
| **适用场景**        | 云原生开发、CI/CD 集成、分布式团队         | 私有化部署、离线环境、自定义需求         |

#### 1. **部署与运维**
- **ACR**：作为托管服务，用户无需关心底层基础设施，阿里云负责服务器、存储和网络的维护，适合希望快速上手的团队。
- **Harbor**：需要自建和维护，部署过程涉及服务器配置、存储选择和网络设置，适合有技术能力和私有化需求的团队。

#### 2. **性能与扩展**
- **ACR**：依托阿里云的全球基础设施，提供镜像加速和跨地域复制功能，适合大规模、分布式的应用场景。
- **Harbor**：性能受限于部署环境，扩展性依赖于硬件资源，适合中小规模或内部使用的场景。

#### 3. **安全性与合规性**
- **ACR**：通过阿里云 RAM 提供细粒度的权限控制，内置漏洞扫描，符合企业级安全要求。
- **Harbor**：支持 RBAC 和漏洞扫描，但安全功能的配置和维护需用户自行完成，适合对安全有自定义需求的场景。

#### 4. **成本与资源**
- **ACR**：按需付费模式，初期成本低，适合云上用户；个人版免费功能有限，企业版按流量和存储计费。
- **Harbor**：开源免费，但需要投入硬件和人力成本，长期运维成本可能较高。

#### 5. **适用场景总结**
- **选择 ACR 的场景**：
  - 已经在阿里云生态中，使用 ACK 进行容器管理。
  - 需要全球加速和跨地域镜像分发。
  - 希望降低运维成本，快速构建 CI/CD 流水线。
- **选择 Harbor 的场景**：
  - 需要私有化部署，镜像数据不能存储在云端。
  - 处于离线环境或对镜像仓库有高度定制化需求。
  - 团队有足够的技术能力进行部署和维护。


### 一、阿里云 ACR 中的命名空间（Namespace）
在阿里云 ACR 中，镜像仓库的管理引入了“命名空间（Namespace）”的概念，作为镜像仓库的逻辑分组单位。以下是命名空间的核心特点和作用：

- **定义**：命名空间是 ACR 中用于组织和管理镜像仓库的逻辑层级，类似于一个大的容器，用于容纳多个镜像仓库（Repository）。
- **层级结构**：
  - 命名空间（Namespace）：顶层分组单位，通常对应一个团队、部门或业务线。
  - 镜像仓库（Repository）：隶属于某个命名空间，用于存储具体的镜像及其版本（Tag）。
- **作用**：
  - **逻辑隔离**：通过命名空间，可以将不同团队或项目的镜像仓库隔离开来，避免命名冲突。
  - **权限管理**：ACR 支持对命名空间级别的权限控制，管理员可以为不同用户或角色分配命名空间的访问权限（如只读、读写）。
  - **管理便捷**：命名空间便于大规模镜像管理，尤其是在企业环境中，可以按业务线或开发团队划分。
- **创建与使用**：
  - 在阿里云控制台中，用户需要先创建一个命名空间（例如 `team-a`），然后在该命名空间下创建具体的镜像仓库（例如 `team-a/nginx`）。
  - 镜像的完整路径为 `命名空间/镜像仓库:标签`，如 `team-a/nginx:1.0.0`。

### 二、Harbor 中的项目（Project）管理
在 Harbor 中，镜像仓库的管理主要基于“项目（Project）”的概念，项目是镜像仓库的直接分组单位。以下是项目的核心特点和作用：

- **定义**：项目是 Harbor 中用于组织和管理镜像仓库的基本单位，通常对应一个具体的应用、团队或业务模块。
- **层级结构**：
  - 项目（Project）：直接作为镜像仓库的容器，没有额外的命名空间层级。
  - 镜像仓库（Repository）：隶属于某个项目，存储具体的镜像及其版本（Tag）。
- **作用**：
  - **逻辑分组**：项目用于将镜像仓库按业务或团队分组，类似于 ACR 的命名空间，但层级更扁平。
  - **权限管理**：Harbor 支持项目级别的权限控制，管理员可以为用户分配项目的角色（如管理员、开发者、访客）。
  - **管理方式**：项目是 Harbor 的核心管理单位，用户直接在项目中创建和管理镜像仓库。
- **创建与使用**：
  - 在 Harbor 的 Web UI 或 CLI 中，用户直接创建一个项目（例如 `team-a`），然后在该项目下创建镜像仓库（例如 `team-a/nginx`）。
  - 镜像的完整路径为 `项目/镜像仓库:标签`，如 `team-a/nginx:1.0.0`。

## 三、ACR 命名空间与 Harbor 项目的区别
根据您的描述，ACR 和 Harbor 在管理镜像仓库时的主要区别在于 ACR 多了一个“命名空间”的概念，而 Harbor 直接使用“项目”进行管理。以下是两者的详细对比：

| **维度**            | **阿里云 ACR（命名空间）**                  | **Harbor（项目）**                      |
|---------------------|--------------------------------------------|-----------------------------------------|
| **管理层级**        | 多层级：命名空间 → 镜像仓库                | 单层级：项目 → 镜像仓库                |
| **命名空间/项目作用** | 命名空间用于逻辑隔离和权限管理，通常对应团队或业务线 | 项目直接用于分组和权限管理，通常对应具体应用或团队 |
| **创建流程**        | 先创建命名空间，再在命名空间下创建镜像仓库  | 直接创建项目，在项目下创建镜像仓库      |
| **镜像路径**        | 命名空间/镜像仓库:标签（如 `team-a/nginx:1.0.0`） | 项目/镜像仓库:标签（如 `team-a/nginx:1.0.0`） |
| **适用场景**        | 适合大规模企业环境，支持更细粒度的逻辑分组  | 适合中小规模团队，管理结构更简单直接    |

### 1. **层级结构的差异**
- **ACR**：引入了“命名空间”作为额外的层级，使得镜像管理更加结构化，适合复杂的组织架构。例如，一个企业可以为每个部门创建一个命名空间（如 `marketing`、`engineering`），然后在每个命名空间下创建多个镜像仓库（如 `marketing/campaign-app`）。
- **Harbor**：直接以“项目”作为分组单位，层级更扁平，适合管理较为简单的场景。例如，一个团队可以为每个应用创建一个项目（如 `web-app`），然后在项目中管理镜像仓库（如 `web-app/frontend`）。

### 2. **创建与管理流程的差异**
- **ACR**：用户需要先创建一个命名空间，然后才能在该命名空间下创建镜像仓库。这增加了管理步骤，但也提供了更清晰的逻辑划分。
- **Harbor**：用户直接创建项目并在项目中管理镜像仓库，流程更简洁，适合快速上手。

### 3. **适用场景的差异**
- **ACR 的命名空间**：更适合大型企业或复杂项目，命名空间可以映射到组织结构中的部门、团队或业务线，便于大规模镜像管理和权限分配。
- **Harbor 的项目**：更适合中小型团队或简单项目，项目直接对应具体的业务需求，管理方式更直观。



### 第四部分：应用部署与 Kubernetes 资源迁移
**目标**：将虚拟机环境中的 Kubernetes 资源迁移到 ACK，并验证功能。

- **内容**：
  1. **部署核心资源**：
     - 使用已熟悉的 YAML 文件部署 Pod、Deployment、StatefulSet 等资源。
     - 配置 ConfigMap 和 Secret，验证数据注入。
     - 使用 DaemonSet 部署节点级应用（如日志采集 agent）。
  2. **网络与访问**：
     - 创建 Service（ClusterIP、NodePort、LoadBalancer 类型）：
       - LoadBalancer 类型会自动绑定阿里云 SLB，实现公网访问。
     - 配置 Ingress-Nginx：
       - 在 ACK 中安装 Ingress-Nginx 控制器。
       - 创建 Ingress 规则，绑定域名并通过 SLB 实现外部访问。
  3. **调度策略**：
     - 使用 nodeSelector、taint 和 toleration 实现 Pod 调度。
     - 配置亲和性（Affinity）规则，确保 Pod 分布在不同可用区。

- **学习任务**：
  - 部署一个简单的应用（如 Nginx），通过 Service 和 Ingress 实现外部访问。
  - 配置调度策略，确保 Pod 分布在不同可用区。


### 第五部分：ACK 高级功能与运维
**目标**：掌握 ACK 提供的日志、监控和自动扩缩容等高级功能。

- **内容**：
  1. **日志管理**：
     - 启用 ACK 的日志服务，收集容器日志并存储到阿里云 SLS（日志服务）。
     - 在控制台查看日志，或通过 API 查询。
  2. **监控与告警**：
     - 启用 Prometheus 监控，查看集群和应用的性能指标。
     - 配置告警规则，及时发现异常。
  3. **自动扩缩容**：
     - 配置 HPA（Horizontal Pod Autoscaler），根据 CPU/内存负载自动调整 Pod 副本数。
     - 配置集群节点自动扩缩容，确保资源弹性。

- **学习任务**：
  - 配置日志收集，查看容器运行日志。
  - 设置一个简单的 HPA 规则，模拟负载并验证自动扩容。


## 总结与实践项目
- **总结**：
  - 复习 ACK 的基本概念、网络集成、集群创建和应用部署。
  - 对比虚拟机 Kubernetes 与 ACK 的异同，总结 ACK 的优势。
- **实践项目**：
  - 部署一个完整的微服务应用（包含前端、后端、数据库），通过 Ingress 实现外部访问。
  - 配置日志和监控，确保应用运行稳定。
  - 模拟高负载场景，验证自动扩缩容功能。


## 教学资源
- 阿里云 ACK 官方文档：https://help.aliyun.com/product/85222.html
- Kubernetes 官方文档：https://kubernetes.io/
- kubectl 命令参考：https://kubernetes.io/docs/reference/kubectl/

